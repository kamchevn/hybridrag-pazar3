{"ast":null,"code":"const BASE_URL = process.env.REACT_APP_API_BASE_URL || 'http://localhost:8080';\n\n/**\r\n * Calls the hybrid ask endpoint and returns only the fields needed by the UI.\r\n * @param {string} query\r\n * @param {string} model\r\n * @returns {Promise<{answer: string, urls: string[], raw: any}>}\r\n */\nexport async function askHybrid(query, model) {\n  var _data, _data2;\n  if (!query || typeof query !== 'string' || !query.trim()) {\n    throw new Error('Внесете прашање.');\n  }\n  if (!model || typeof model !== 'string' || !model.trim()) {\n    throw new Error('Изберете модел.');\n  }\n  const url = `${BASE_URL}/api/hybrid/ask` + `?q=${encodeURIComponent(query.trim())}` + `&model=${encodeURIComponent(model.trim())}`;\n  let response;\n  try {\n    response = await fetch(url, {\n      method: 'GET',\n      headers: {\n        Accept: 'application/json'\n      }\n    });\n  } catch (networkErr) {\n    throw new Error('Неуспешно поврзување со серверот. Обидете се повторно.');\n  }\n  let data;\n  if (!response.ok) {\n    // Try to read body (text) for more helpful message, but keep bounded\n    const bodyText = await response.text().catch(() => '');\n    const shortText = bodyText ? ` | ${bodyText.slice(0, 200)}` : '';\n    throw new Error(`HTTP грешка ${response.status}${shortText}`);\n  }\n  try {\n    data = await response.json();\n  } catch (parseErr) {\n    throw new Error('Неуспешно читање на одговорот (JSON).');\n  }\n  const answer = typeof ((_data = data) === null || _data === void 0 ? void 0 : _data.answer) === 'string' ? data.answer : '';\n  const urls = Array.isArray((_data2 = data) === null || _data2 === void 0 ? void 0 : _data2.listings) ? data.listings.map(item => item && item.url).filter(Boolean) : [];\n  const dedupedUrls = Array.from(new Set(urls));\n  return {\n    answer,\n    urls: dedupedUrls,\n    raw: data\n  };\n}","map":{"version":3,"names":["BASE_URL","process","env","REACT_APP_API_BASE_URL","askHybrid","query","model","_data","_data2","trim","Error","url","encodeURIComponent","response","fetch","method","headers","Accept","networkErr","data","ok","bodyText","text","catch","shortText","slice","status","json","parseErr","answer","urls","Array","isArray","listings","map","item","filter","Boolean","dedupedUrls","from","Set","raw"],"sources":["C:/Users/kamch/emt-frontend/src/api/hybridClient.js"],"sourcesContent":["const BASE_URL = process.env.REACT_APP_API_BASE_URL || 'http://localhost:8080';\r\n\r\n/**\r\n * Calls the hybrid ask endpoint and returns only the fields needed by the UI.\r\n * @param {string} query\r\n * @param {string} model\r\n * @returns {Promise<{answer: string, urls: string[], raw: any}>}\r\n */\r\nexport async function askHybrid(query, model) {\r\n  if (!query || typeof query !== 'string' || !query.trim()) {\r\n    throw new Error('Внесете прашање.');\r\n  }\r\n  if (!model || typeof model !== 'string' || !model.trim()) {\r\n    throw new Error('Изберете модел.');\r\n  }\r\n\r\n  const url =\r\n    `${BASE_URL}/api/hybrid/ask` +\r\n    `?q=${encodeURIComponent(query.trim())}` +\r\n    `&model=${encodeURIComponent(model.trim())}`;\r\n\r\n  let response;\r\n  try {\r\n    response = await fetch(url, {\r\n      method: 'GET',\r\n      headers: {\r\n        Accept: 'application/json'\r\n      }\r\n    });\r\n  } catch (networkErr) {\r\n    throw new Error('Неуспешно поврзување со серверот. Обидете се повторно.');\r\n  }\r\n\r\n  let data;\r\n  if (!response.ok) {\r\n    // Try to read body (text) for more helpful message, but keep bounded\r\n    const bodyText = await response.text().catch(() => '');\r\n    const shortText = bodyText ? ` | ${bodyText.slice(0, 200)}` : '';\r\n    throw new Error(`HTTP грешка ${response.status}${shortText}`);\r\n  }\r\n  try {\r\n    data = await response.json();\r\n  } catch (parseErr) {\r\n    throw new Error('Неуспешно читање на одговорот (JSON).');\r\n  }\r\n\r\n  const answer = typeof data?.answer === 'string' ? data.answer : '';\r\n  const urls = Array.isArray(data?.listings)\r\n    ? data.listings\r\n        .map((item) => item && item.url)\r\n        .filter(Boolean)\r\n    : [];\r\n  const dedupedUrls = Array.from(new Set(urls));\r\n\r\n  return {\r\n    answer,\r\n    urls: dedupedUrls,\r\n    raw: data\r\n  };\r\n}\r\n\r\n\r\n\r\n"],"mappings":"AAAA,MAAMA,QAAQ,GAAGC,OAAO,CAACC,GAAG,CAACC,sBAAsB,IAAI,uBAAuB;;AAE9E;AACA;AACA;AACA;AACA;AACA;AACA,OAAO,eAAeC,SAASA,CAACC,KAAK,EAAEC,KAAK,EAAE;EAAA,IAAAC,KAAA,EAAAC,MAAA;EAC5C,IAAI,CAACH,KAAK,IAAI,OAAOA,KAAK,KAAK,QAAQ,IAAI,CAACA,KAAK,CAACI,IAAI,CAAC,CAAC,EAAE;IACxD,MAAM,IAAIC,KAAK,CAAC,kBAAkB,CAAC;EACrC;EACA,IAAI,CAACJ,KAAK,IAAI,OAAOA,KAAK,KAAK,QAAQ,IAAI,CAACA,KAAK,CAACG,IAAI,CAAC,CAAC,EAAE;IACxD,MAAM,IAAIC,KAAK,CAAC,iBAAiB,CAAC;EACpC;EAEA,MAAMC,GAAG,GACP,GAAGX,QAAQ,iBAAiB,GAC5B,MAAMY,kBAAkB,CAACP,KAAK,CAACI,IAAI,CAAC,CAAC,CAAC,EAAE,GACxC,UAAUG,kBAAkB,CAACN,KAAK,CAACG,IAAI,CAAC,CAAC,CAAC,EAAE;EAE9C,IAAII,QAAQ;EACZ,IAAI;IACFA,QAAQ,GAAG,MAAMC,KAAK,CAACH,GAAG,EAAE;MAC1BI,MAAM,EAAE,KAAK;MACbC,OAAO,EAAE;QACPC,MAAM,EAAE;MACV;IACF,CAAC,CAAC;EACJ,CAAC,CAAC,OAAOC,UAAU,EAAE;IACnB,MAAM,IAAIR,KAAK,CAAC,wDAAwD,CAAC;EAC3E;EAEA,IAAIS,IAAI;EACR,IAAI,CAACN,QAAQ,CAACO,EAAE,EAAE;IAChB;IACA,MAAMC,QAAQ,GAAG,MAAMR,QAAQ,CAACS,IAAI,CAAC,CAAC,CAACC,KAAK,CAAC,MAAM,EAAE,CAAC;IACtD,MAAMC,SAAS,GAAGH,QAAQ,GAAG,MAAMA,QAAQ,CAACI,KAAK,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE,GAAG,EAAE;IAChE,MAAM,IAAIf,KAAK,CAAC,eAAeG,QAAQ,CAACa,MAAM,GAAGF,SAAS,EAAE,CAAC;EAC/D;EACA,IAAI;IACFL,IAAI,GAAG,MAAMN,QAAQ,CAACc,IAAI,CAAC,CAAC;EAC9B,CAAC,CAAC,OAAOC,QAAQ,EAAE;IACjB,MAAM,IAAIlB,KAAK,CAAC,uCAAuC,CAAC;EAC1D;EAEA,MAAMmB,MAAM,GAAG,SAAAtB,KAAA,GAAOY,IAAI,cAAAZ,KAAA,uBAAJA,KAAA,CAAMsB,MAAM,MAAK,QAAQ,GAAGV,IAAI,CAACU,MAAM,GAAG,EAAE;EAClE,MAAMC,IAAI,GAAGC,KAAK,CAACC,OAAO,EAAAxB,MAAA,GAACW,IAAI,cAAAX,MAAA,uBAAJA,MAAA,CAAMyB,QAAQ,CAAC,GACtCd,IAAI,CAACc,QAAQ,CACVC,GAAG,CAAEC,IAAI,IAAKA,IAAI,IAAIA,IAAI,CAACxB,GAAG,CAAC,CAC/ByB,MAAM,CAACC,OAAO,CAAC,GAClB,EAAE;EACN,MAAMC,WAAW,GAAGP,KAAK,CAACQ,IAAI,CAAC,IAAIC,GAAG,CAACV,IAAI,CAAC,CAAC;EAE7C,OAAO;IACLD,MAAM;IACNC,IAAI,EAAEQ,WAAW;IACjBG,GAAG,EAAEtB;EACP,CAAC;AACH","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}